SELECT 
    TRANSACTION_DATE,
    SUBSIDIARY,
    GMV_AMOUNT,
    TRANSACTION_COUNT,
    PROCESSING_DATE,
    TRANSACTION_TIMESTAMP
FROM (
    SELECT *,
           ROW_NUMBER() OVER (
               PARTITION BY TRANSACTION_DATE, SUBSIDIARY
               ORDER BY PROCESSING_DATE DESC
           ) AS rn
    FROM FACT_DAILY_GMV_SUBSIDIARY
) t
WHERE rn = 1
ORDER BY TRANSACTION_DATE, SUBSIDIARY;
